% !TEX root = research_paper.tex

\section{Treatment Effect Estimation} % (fold)
\label{sec: estim}

To estimate the causal effect we want to fit a regression function to the data at hand by means of OLS and WLS. Here, we disregard any covariates and regressor values stem from the treatment indicator $D$, running variable $R$ and polynomials thereof. Essentially, we are interested in the difference of the regression function's values when approaching the cutoff from above vis-Ã -vis below and we allow the regression function to behave differently on the left and right side of the cutoff. Throughout our work, we estimate models of the following kind:

\begin{equation}

Y = \alpha + \tau D + f^{l}(R) + f^{r}(R) + \epsilon .
\label{eq: model_general}

\end{equation}

Under the identification assumptions laid out above $\tau$ recovers the causal effect. Further, $\alpha$ is the intercept and $\epsilon$ constitutes the mean-zero idiosyncratic element. The functions $f^{l}$ and $f^{r}$ are our main objects of interest and we want to investigate how they affect the treatment effect estimator $\tau$.

Identifying causal effects in RDD applications relies by construction on a \textit{locational} feature in the data; treatment assignment discontinuously changes at a specific value of the running variable. This motivates our desire to fit the functional form of the true regression function, especially around the cutoff. In such a setting misspecification of functional forms emerges to be more severe as it may introduce biased estimates of the treatment effect \cite{lee_lemieux_2010}. For intuition suppose the true functional form is nonlinear and we estimate it by means of a linear model. We can still recover a linear prediction which minimizes some criterion, say the sum of squared residuals. While the \textit{best} linear prediction relates to the entire data, at particular points in the regressor's domain we may still be left with serious specification errors. In a RDD study the cutoff may constitute such a specific point, and the estimate would be biased. To reduce specification errors, polynomials of the running variable may be included which can capture (specific) nonlinearities. However, it is not granted that bias due to a misspecified functional form vanishes. Again, note that in RDD the treatment effect inherits a sense of location as it is closely tied to the cutoff determining treatment assignment. Our aim is to get the functional form close to the cutoff right and it is not always clear that data far away from the cutoff can help us to achieve that. In fact, we need to be well informed about the underlying data-generating process to make a case for parametrically estimating the treatment effect using all data available.

Hence, the estimation problem in RDD is widely considered to be addressed by nonparametric methods which relax functional form assumptions and pay closer attention to the treatment effect's locational feature by allowing to restrict data to the cutoff's vicinity, \cite{hahn_et_al}) and \cite{lee_lemieux_2010}. The choice of bandwidth restricts the data to be included in the estimation and is thus crucial as it controls model complexity, that is, a larger bandwidth imposes more structure on the data resulting in higher precision but perhaps bias. Again, this brings up the trade-off between bias and precision which nicely reflects our thinking about global and local models. Moreover, as it is common to believe that data closer to the point of interest depict relationships between the regressor and the response variable which are more accurately describing the relationship at the point of interest compared to points far away, a kernel function is used to assign more weight to observations closer to the point of interest.


\subsection{Parametric Treatment Effect Estimation} % (fold)
\label{sec: param}
In this project we estimate the treatment effect by means of OLS and allow different functional forms on either side of the RDD cutoff. We implement this by interacting the running variable (and polynomials thereof) with the treatment indicator. As common in RDD applications we center the running variable by subtracting the cutoff \cite{lee_lemieux_2010}. The linear model with polynomial degree one thus writes:

\begin{equation}
Y = \alpha + \tau D + \beta_{l} (R-c) + (\beta_{r} - \beta_{l}) (R-c) D + \epsilon .
\label{eq: model_general}
\end{equation}

Similarly, the quadratic model is given by

\begin{equation}
Y = \alpha + \tau D + \beta_{l} (R-c) + (\beta_{r} - \beta_{l}) (R-c) D + \gamma_{l} (R-c)^2 + (\gamma_{r} - \gamma_{l}) (R-c)^2 D + \epsilon .
\end{equation}

In our simulation study and real data application we estimate models with zero up to four polynomial degrees. (Note that a model of zero degree simply returns the difference in means of all individuals below and above the cutoff).



\subsection{Non-parametric Treatment Effect Estimation} % (fold)
\label{sec: non-param}
For estimation by means of local linear regression we can (luckily) rely on general results established by the weighted least squares literature. Here, the weighing scheme is specified by the triangle kernel $K(r) = \max \lbrace 0, 1 - \vert r \vert \rbrace$, a non-negative function with bounded support that assigns a higher weight to observations with regressor values close to the point of interest. \cite{cheng_et_al_1997} show that the triangle kernel is boundary optimal in the sense of minimizing the asymptotic mean squared error at boundary points. As we are interested in estimation at a boundary point -- the RDD cutoff --, we employ the triangle kernel throughout our work. As stated, local linear regressions require a smoothing parameter, the bandwidth, which restricts the data used and we build on two data-driven bandwidth selection procedures. First, the rule-of-thumb bandwidth selection uses the expression for the asymptotically optimal bandwidth and plugs in estimates of unknown quantities \cite{fan_gij_1996}. Second, a bandwidth procedure based on cross-validation which aims to minimize the mean squared error of in-sample predictions. The algorithms required to obtain these bandwidths is discussed in detail below, for implementation details the reader is directed to the project documentation and the available code. Let $h$ be the bandwidth and $\mathds{1}$ depicts the indicator function. We estimate the following pooled regression by means of weighted least squares:


\textit{TODO: how to best present the model in accordance with our implementation...
\begin{equation}
Y = \alpha + \tau D + \beta_{l} (R-c) + (\beta_{r} - \beta_{l}) (R-c) D + \epsilon .

\left( \mathds{1}_{X_{j}>c} \mathds{1}_{r \geq c} + \mathds{1}_{X_{j}<c} \mathds{1}_{r < c} \right) .


\label{eq: model_general}
\end{equation}




\subsection{Parametric or non-parametric?} % (fold)
\label{sec: para discussion}
Parametric and non-parametric treatment effect estimation, as presented here, are fundamentally different since non-parametric methods relax functional form assumptions, constrain the dataset and face different statistical properties. However, in a sense, the non-parametric model can be understood as a generalization of the parametric model since for given data and when choosing the uniform kernel and the bandwidth to coincide with the regressor's support the non-parametric and parametric model are in fact the same. Hence, parametric and non-parametric approaches are sometimes called \textit{global} and \textit{local} methods, respectively. That being said, we want to briefly discuss the trade-offs between these two methods and highlight those in our simulation study and real data application.

The principle trade-off emerges along bias and precision. As stated above, misspecifing the functional form can introduce bias in the treatment estimate in RDD, and we expect flexible non-parametric methods to be better suited to avoid bias. This potential advantage if surely more leveraged in data structures that exhibit stark non-linearities which are hard to capture with polynomial specifications. If we on the other hand are well informed about the true process that generated the data, a treatment effect estimated by a parametric model may not suffer from specification error. In that case, it may even be advisable to use a parametric model as it potentially yields more precise estimates, simply because all data available are used. Also, in settings with very few observations global methods may outperform non-parametric methods as the latter rely on more observations due to their slower convergence rates.





